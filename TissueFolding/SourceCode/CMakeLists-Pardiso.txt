cmake_minimum_required(VERSION 3.10)

# define the project we are building
project(TissueFolding VERSION 1.0)

# for this build, we are using C++14, set standard
set(CMAKE_CXX_STANDARD 14)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# need to find pardiso (if compiling with Pardiso): https://pardiso-project.org/manual/manual.pdf

# FOR RUNNING THE CODE, the following environment variables must be set!
# LD_LIBRARY_PATH must point to the Pardiso library (.so file)
# OMP_NUM_THREADS (if using multi-threaded version)
# The license key must be in the home directory OR the directory the executable is run from

# For linking to Pardiso, we require the user to have supplied the location of the PARDISO library
if(DEFINED PARDISO_LIB_LOC)
    message(STATUS "Pardiso location provided: ${PARDISO_LIB_LOC}")
else()
    message(FATAL_ERROR "Pardiso location not provided")
    # We could also attempt to manually find the library ourselves, in the event of an error
    #find_library(PARDISO_LIB_LOC NAMES pardiso600-GNU720-X86-64 REQUIRED)
endif()

# the executable we want to compile
add_executable(TissueFolding
                main.cpp
                Prism.cpp
                ReferenceShapeBase.cpp
                ShapeBase.cpp
                Simulation.cpp
                Node.cpp
                ModelInputObject.cpp
                RandomGenerator.cpp
                NewtonRaphsonSolver.cpp
                Analysis.cpp
                Lumen.cpp
                TimeSeriesPhysicalProperties.cpp
                YoungsModulusModifier.cpp
)

target_include_directories(TissueFolding PUBLIC
                "${PROJECT_SOURCE_DIR}"
                "${PROJECT_BINARY_DIR}"
)

target_link_directories(TissueFolding PUBLIC
                "${PARDISO_LIB_LOC}"
)

target_compile_options(TissueFolding PUBLIC
                -fopenmp
)

target_link_libraries(TissueFolding PUBLIC
                gsl
                gslcblas
                gomp
                lapack
                pardiso600-GNU720-X86-64
                pthread
)